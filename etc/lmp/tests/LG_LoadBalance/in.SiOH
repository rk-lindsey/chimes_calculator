units       real                # Required for chimes pairstyle
newton      on              # Required for chimes pairstyle

atom_style  atomic              # Required for chimes pairstyle
atom_modify sort 0 0.0          # Required for chimes pairstyle (allowing sorting may screw up 3b parent/neighbor relationships)
atom_modify map array           # May be more efficient

neighbor        2.0 bin
neigh_modify    delay 0 every 1 check yes

read_data data.SiOH
velocity all  create 300.0  100002 mom yes rot yes dist gaussian

#### FORCE FIELD CONTROLS ####

pair_style  chimesFF for_fitting
pair_coeff  * * params.txt.reduced

fix 1 all nve
fix 2 all langevin 300.0 300.0 100 747
# fix_modify 2 energy yes    ## replaced by econserve
comm_style tiled
fix 3 all balance 100 1.1 rcb  

timestep 0.05

compute         ke_tensor all temp
thermo_style    custom step time ke pe etotal temp press pxx pyy pzz pxy pxz pyz vol c_ke_tensor[1] c_ke_tensor[2] c_ke_tensor[3] c_ke_tensor[4] c_ke_tensor[5] c_ke_tensor[6] econserve  # econserve replaces fix_modify
thermo_modify   line one format float %20.5f flush yes
thermo          1


dump        1 all custom 25 traj.lammpstrj id type element x y z fx fy fz # print wrapped coordinates for 1 timestep
dump_modify 1 sort id element H O Si

dump        2 all custom 25 traj.lmp id type element xu yu zu
dump_modify 2 sort id element H O Si

restart 2000 a.long.restart b.long.restart

run 1000000
