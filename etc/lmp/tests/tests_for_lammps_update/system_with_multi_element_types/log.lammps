LAMMPS (29 Aug 2024 - Update 1)
##########################################
##########################################
# NPT - testing LAMMPS in ChIMES Calculator
##########################################
##########################################


##########################################
# USER-SPECIFIED VARIABLES
##########################################

variable tstep               equal  0.5                                        # timestep in fs
variable run_steps           equal  500                                        # Number of steps to run
variable temperature         equal  6500                                       # Temperature (K)
variable pressure            equal  296077                                     # Target pressure (atm)

variable io_freq             equal  10                                         # Frequency of dumping trajectory (500 steps, 250 fs)

variable data_file           string /scratch/08034/tg873340/LAMMPS_test/lammps_data_files/CO.2.5gcc_6500K.OUTCAR_000_replicate_x3_y2_z2.data.in
variable param_file          string /scratch/08034/tg873340/LAMMPS_test/chimes_parameter_files/published_params.liqCO.2+3b.cubic.txt

########################################
# GENERAL CONTROLS
########################################

units           real                          # Required for CHIMES pair style
newton          on                            # Required for CHIMES pair style
atom_style      atomic                        # Required for CHIMES pair style
atom_modify     sort 0 0.0                    # Prevent sorting (to maintain 3b parent/neighbor relationships)
atom_modify     map array                     # May improve efficiency

neighbor        2.0 bin
neigh_modify    delay 0 every 1 check yes

########################################
# INITIALIZATION CONTROLS
########################################

read_data       ${data_file}
read_data       /scratch/08034/tg873340/LAMMPS_test/lammps_data_files/CO.2.5gcc_6500K.OUTCAR_000_replicate_x3_y2_z2.data.in
Reading data file ...
  orthogonal box = (0 0 0) to (23.64864 24.43664 23.84692)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  1536 atoms
  read_data CPU = 0.004 seconds
velocity        all create ${temperature} 1234 dist gaussian mom yes rot yes loop all  # Assign initial velocity (comment this line out when reading from a restart file)
velocity        all create 6500 1234 dist gaussian mom yes rot yes loop all  


########################################
# FORCE FIELD CONTROLS
########################################

pair_style      chimesFF
pair_coeff      * * ${param_file}
pair_coeff      * * /scratch/08034/tg873340/LAMMPS_test/chimes_parameter_files/published_params.liqCO.2+3b.cubic.txt


########################################
# RESTART CONTROLS
########################################

restart         ${io_freq} a.restart b.restart	 # Write restart files
restart         10 a.restart b.restart	 

########################################
# RUN, DUMP, AND THERMO CONTROLS
########################################

##### Set the ensemble
variable temp_damp  equal  v_tstep*100.0	# Temperature damping coefficient
variable press_damp equal  v_tstep*1000.0	# Pressure damping coefficient
fix             1 all nvt temp ${temperature} ${temperature} ${temp_damp}
fix             1 all nvt temp 6500 ${temperature} ${temp_damp}
fix             1 all nvt temp 6500 6500 ${temp_damp}
fix             1 all nvt temp 6500 6500 50

##### Define thermo output
variable e_ensemble        equal f_1
variable e_conserve        equal ke+pe+v_e_ensemble
thermo_style    custom step time temp press density ke pe etotal v_e_ensemble v_e_conserve econserve
thermo_modify   line one format float %20.5f flush yes
thermo          ${io_freq}
thermo          10

##### Dump all atoms
#dump            dump_1 carbon ${io_freq} traj.lammpstrj id type element xu yu zu vx vy vz
#dump_modify     dump_1 sort id element C O

##### Run the simulation

timestep        ${tstep}
timestep        0.5
run             ${run_steps} upto
run             500 upto

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- Type Label Framework: https://doi.org/10.1021/acs.jpcb.3c08419

@Article{Gissinger24,
 author = {Jacob R. Gissinger, Ilia Nikiforov, Yaser Afshar, Brendon Waters, Moon-ki Choi, Daniel S. Karls, Alexander Stukowski, Wonpil Im, Hendrik Heinz, Axel Kohlmeyer, and Ellad B. Tadmor},
 title = {Type Label Framework for Bonded Force Fields in LAMMPS},
 journal = {J. Phys. Chem. B},
 year =    2024,
 volume =  128,
 number =  13,
 pages =   {3282â€“-3297}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 10
  ghost atom cutoff = 10
  binsize = 5, bins = 5 5 5
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair chimesFF, perpetual
      attributes: full, newton on, ghost
      pair build: full/bin/ghost
      stencil: full/ghost/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 16.32 | 16.32 | 16.32 Mbytes
   Step          Time           Temp          Press         Density         KinEng         PotEng         TotEng      v_e_ensemble   v_e_conserve    Econserve   
         0               0.00000           6500.00000         488451.09061              2.59206          29741.03227        -235828.14621        -206087.11394              0.00000        -206087.11394        -206087.11394
        10               5.00000           7188.32668         419859.90300              2.59206          32890.50089        -239028.76040        -206138.25950             20.21738        -206118.04212        -206118.04212
        20              10.00000           6650.75300         408085.57027              2.59206          30430.80917        -236639.62306        -206208.81389             97.43673        -206111.37716        -206111.37716
        30              15.00000           6645.63771         417028.18706              2.59206          30407.40395        -236716.36931        -206308.96536            193.08728        -206115.87808        -206115.87808
        40              20.00000           6661.58417         432042.44620              2.59206          30480.36766        -236897.09975        -206416.73209            302.83714        -206113.89495        -206113.89495
        50              25.00000           6732.05417         427538.33824              2.59206          30802.80619        -237350.41860        -206547.61241            432.20214        -206115.41027        -206115.41027
        60              30.00000           6614.28671         421232.41037              2.59206          30263.95608        -236961.09758        -206697.14150            581.47904        -206115.66246        -206115.66246
        70              35.00000           6533.82310         413141.96050              2.59206          29895.79131        -236747.90165        -206852.11034            735.30026        -206116.81008        -206116.81008
        80              40.00000           6520.65243         398116.65021              2.59206          29835.52838        -236836.93752        -207001.40914            884.50516        -206116.90399        -206116.90399
        90              45.00000           6373.42829         407986.16874              2.59206          29161.89793        -236299.99948        -207138.10156           1022.72060        -206115.38096        -206115.38096
       100              50.00000           6477.46354         401778.11426              2.59206          29637.91572        -236892.60710        -207254.69139           1138.24476        -206116.44662        -206116.44662
       110              55.00000           6639.89582         399612.42922              2.59206          30381.13166        -237743.71152        -207362.57986           1245.23812        -206117.34173        -206117.34173
       120              60.00000           6574.19985         401016.97746              2.59206          30080.53690        -237546.99515        -207466.45825           1350.03561        -206116.42264        -206116.42264
       130              65.00000           6572.42670         394488.00510              2.59206          30072.42377        -237636.79838        -207564.37461           1448.75820        -206115.61641        -206115.61641
       140              70.00000           6596.59796         396205.47420              2.59206          30183.02043        -237841.08933        -207658.06890           1541.51626        -206116.55264        -206116.55264
       150              75.00000           6546.92215         406691.66196              2.59206          29955.72662        -237703.90527        -207748.17865           1628.95640        -206119.22225        -206119.22225
       160              80.00000           6410.88453         408868.51739              2.59206          29333.28057        -237152.46291        -207819.18234           1703.67779        -206115.50455        -206115.50455
       170              85.00000           6472.04811         399408.83421              2.59206          29613.13720        -237493.93265        -207880.79546           1762.56373        -206118.23172        -206118.23172
       180              90.00000           6372.20478         407688.70003              2.59206          29156.29972        -237080.94667        -207924.64695           1807.72377        -206116.92318        -206116.92318
       190              95.00000           6408.12347         399952.74031              2.59206          29320.64724        -237272.64907        -207952.00183           1836.64438        -206115.35745        -206115.35745
       200             100.00000           6434.24339         397446.27600              2.59206          29440.16005        -237411.79095        -207971.63090           1855.72157        -206115.90932        -206115.90932
       210             105.00000           6500.20284         405843.56729              2.59206          29741.96036        -237726.16787        -207984.20751           1867.71407        -206116.49344        -206116.49344
       220             110.00000           6641.17380         398202.49810              2.59206          30386.97912        -238382.10169        -207995.12257           1879.77484        -206115.34773        -206115.34773
       230             115.00000           6601.78132         394889.55023              2.59206          30206.73711        -238226.26410        -208019.52699           1903.75723        -206115.76976        -206115.76976
       240             120.00000           6492.53471         392467.58245              2.59206          29706.87454        -237758.50706        -208051.63252           1934.63673        -206116.99579        -206116.99579
       250             125.00000           6446.56607         394760.13303              2.59206          29496.54301        -237575.01789        -208078.47487           1961.95171        -206116.52317        -206116.52317
       260             130.00000           6478.69445         407951.49905              2.59206          29643.54780        -237744.25659        -208100.70878           1983.78591        -206116.92287        -206116.92287
       270             135.00000           6555.25769         411938.42389              2.59206          29993.86623        -238115.57645        -208121.71022           2003.39874        -206118.31149        -206118.31149
       280             140.00000           6579.99234         397829.19515              2.59206          30107.04072        -238250.34105        -208143.30033           2026.12036        -206117.17998        -206117.17998
       290             145.00000           6538.06269         393135.14384              2.59206          29915.18979        -238086.79347        -208171.60368           2054.52547        -206117.07821        -206117.07821
       300             150.00000           6568.21973         397174.71848              2.59206          30053.17462        -238254.10249        -208200.92787           2085.45684        -206115.47103        -206115.47103
       310             155.00000           6538.15953         400848.74809              2.59206          29915.63287        -238155.24597        -208239.61310           2123.44525        -206116.16785        -206116.16785
       320             160.00000           6433.51895         396144.66932              2.59206          29436.84535        -237718.71319        -208281.86784           2164.11599        -206117.75185        -206117.75185
       330             165.00000           6406.78302         385909.19655              2.59206          29314.51395        -237630.10780        -208315.59385           2198.55087        -206117.04298        -206117.04298
       340             170.00000           6348.22299         396689.72033              2.59206          29046.56998        -237386.52244        -208339.95246           2223.40465        -206116.54780        -206116.54780
       350             175.00000           6465.71248         404277.78306              2.59206          29584.14826        -237938.17148        -208354.02322           2236.82383        -206117.19940        -206117.19940
       360             180.00000           6527.96169         399754.99222              2.59206          29868.97219        -238235.19028        -208366.21809           2247.41206        -206118.80604        -206118.80604
       370             185.00000           6493.89790         393022.70373              2.59206          29713.11184        -238092.64816        -208379.53632           2259.05335        -206120.48297        -206120.48297
       380             190.00000           6343.15603         395315.53046              2.59206          29023.38589        -237407.80399        -208384.41810           2267.05656        -206117.36154        -206117.36154
       390             195.00000           6329.34995         397923.06096              2.59206          28960.21554        -237339.73605        -208379.52051           2262.35144        -206117.16907        -206117.16907
       400             200.00000           6312.05252         405637.58786              2.59206          28881.07040        -237239.50056        -208358.43017           2241.76034        -206116.66983        -206116.66983
       410             205.00000           6391.16559         405020.13648              2.59206          29243.05569        -237563.86001        -208320.80432           2202.21989        -206118.58443        -206118.58443
       420             210.00000           6438.44529         404967.69214              2.59206          29459.38603        -237721.08405        -208261.69803           2145.38037        -206116.31765        -206116.31765
       430             215.00000           6555.84379         394943.34109              2.59206          29996.54796        -238187.91506        -208191.36711           2074.01635        -206117.35076        -206117.35076
       440             220.00000           6526.45702         399355.46006              2.59206          29862.08751        -237974.11163        -208112.02412           1995.10279        -206116.92132        -206116.92132
       450             225.00000           6548.62575         400348.29201              2.59206          29963.52152        -237985.16974        -208021.64822           1904.96626        -206116.68196        -206116.68196
       460             230.00000           6554.48345         393723.10691              2.59206          29990.32366        -237910.73633        -207920.41266           1802.32983        -206118.08283        -206118.08283
       470             235.00000           6493.85373         398443.81587              2.59206          29712.90974        -237516.22618        -207803.31644           1685.68971        -206117.62673        -206117.62673
       480             240.00000           6505.53689         414922.48884              2.59206          29766.36655        -237428.06113        -207661.69458           1545.42846        -206116.26612        -206116.26612
       490             245.00000           6554.18455         420295.32968              2.59206          29988.95601        -237489.85955        -207500.90354           1382.80997        -206118.09357        -206118.09357
       500             250.00000           6704.26856         401871.91139              2.59206          30675.67193        -237997.90908        -207322.23715           1203.67778        -206118.55937        -206118.55937
Loop time of 681.497 on 1 procs for 500 steps with 1536 atoms

Performance: 0.032 ns/day, 757.218 hours/ns, 0.734 timesteps/s, 1.127 katom-step/s
99.4% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 676.5      | 676.5      | 676.5      |   0.0 | 99.27
Neigh   | 4.5911     | 4.5911     | 4.5911     |   0.0 |  0.67
Comm    | 0.029987   | 0.029987   | 0.029987   |   0.0 |  0.00
Output  | 0.35437    | 0.35437    | 0.35437    |   0.0 |  0.05
Modify  | 0.012575   | 0.012575   | 0.012575   |   0.0 |  0.00
Other   |            | 0.006902   |            |       |  0.00

Nlocal:           1536 ave        1536 max        1536 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           7914 ave        7914 max        7914 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:       715242 ave      715242 max      715242 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 715242
Ave neighs/atom = 465.65234
Neighbor list builds = 50
Dangerous builds = 0
Total wall time: 0:11:24
